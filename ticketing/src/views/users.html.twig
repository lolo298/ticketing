{% extends "base.html.twig" %}

{% block title %}Users
{% endblock %}

{% block content %}
	<div>
		<table>
			<thead>
				<tr>
					<th>Id</th>
					<th>Login</th>
					<th>Role</th>
					<th>Actif</th>
					<th>Creation</th>
				</tr>
			</thead>
			<tbody>
				{% for user in users %}
					<tr id="user-{{user.id}}" data-id="{{user.id}}" class="user">
						<td>{{ user.id }}</td>
						<td>{{ user.login }}</td>
						<td>
							<select id="role-{{user.id}}" class="role">
								{% for role in roles %}
									<option value="{{ role.id }}" {% if role.id == user.role.id %}selected{% endif %}>{{ role }}</option>
								{% endfor %}
							</select>
						</td>
						<td>
							<input type="checkbox" id="actif-{{user.id}}" class="actif" {% if user.actif %}checked{% endif %} />
						</td>
						<td>{{ user.creationDate|date('d/m/Y H:i:s') }}</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
		<p style="color:red">{{ error }}</p>
		<button id="newUserBtn">Nouvel utilisateur</button>

		<dialog id="newUserModal" class="modal" data-trigger="#newUserBtn" data-close="#closeNewUserBtn">
			<form method="POST" action="{{ path('newUser') }}">
				<label for="login">Login</label>
				<input type="text" name="login" id="login" required>

				<label for="password">Password</label>
				<input type="password" name="password" id="password" required>

				<label for="role">Role</label>
				<select name="role" id="role">
				{% for role in roles %}
					<option value="{{ role.id }}">{{ role }}</option>
				{% endfor %}
				</select>

				<button type="submit">Envoyer</button>
				<input type="reset" id="closeNewUserBtn"/>
			</form>

	</div>

{% endblock %}

{% block script %}
	{{ parent() }}
	<script src="/public/js/index.js"></script>
	<script src="/public/js/users.js"></script>
{% endblock %}
